---
layout: post
title: XbeeでAD値をとってくるテスト
permalink: http://moxus.org/916
post_id: 916
categories: 
- Xbee
- 制作
---

以前Xbeeを使ってあまっていてました。で、もったいないので、APIモードで間にマイコン使わずフィジカルコントローラとして使えないかとおもったので自分用メモ。

 

以前はATモードで単にシリアルをスルーさせるだけだったので何もしないでも動いたけど、APIモードダととたんに設定項目が増えて最初分からなかった。

今回は秋月の三軸加速度センサーを使用。xyzアナログ値をXbeeのAPIモードでAD変換して親機に送りPCのシリアルポートと通信させる。電源は3.7vのボタン電池で駆動。

以下メモ。
・子機はサンプル周期の設定(コマンドIR)をすれば勝手にAPIモードに
・その際親機のAPIモードはEnableに
・今回D0~D2ピンをADモードで使うのでD0-D2コマンドで2(ADC)に
・AD値のリファレンスボルテージをVREF Pin (14pin)に落としてあげないとAD値が正しく出ない（コマンドAVでインターナルのリファレンスに設定すれば必要ないっぽい）今回は3.3v
・0x92コマンドなんぞ
・X-CTU無くても設定コマンド手打ちで設定出来るけどいったんAPIモードに設定した後つらい

 

3.7vのボタン電池のはずが5v近く出ていたので仕方なくレギュレータ回路を挟む事に。
Xbee<>USBエクスプローラを使ってるのはピッチ変換買うのがめんどくさかったから、このへんもっと小型にできるはず。

送られてくるUART dataの内容とかはまた後で、有効にしたピンの数で長さが可変するみたい。

![](/images/P1030273.jpg)

![](/images/P1030274.jpg)

![](/images/P1030272.jpg)